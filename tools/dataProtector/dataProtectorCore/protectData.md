# protectData

The iExec tool suite supports deployment of applications where the user of the
application has complete and total control over access to their data. This
ensures privacy and security when invoking these applications. Through use of
the `protectData` method, a user may encrypt and secure any type of data.
Encryption occurs on the client side, supporting the user's control over their
data.

## Usage

The method accepts a JSON object containing the data to encrypt and an optional
name to identify the data.

An email address, for example, may be submitted as:

```js
const protectedData = await dataProtector.protectData({
  data: {
    email: 'example@gmail.com',
  },
});
```

Your object may contain any number of custom keys. The following example
illustrates protection of multiple categories of data within one object:

```js
const protectedData = await dataProtector.protectData({
  data: {
    email: 'example@gmail.com',
    SMTPserver: {
      port: 5000,
      smtp_server: 'smtp.gmail.com',
    },
  },
});
```

## Parameters

```ts twoslash
import { type ProtectDataParams } from '@iexec/dataprotector';
```

### data

`DataObject`

This is the actual data the user is protecting, provided as a JSON object with
any number of custom keys. The data is encrypted and stored as an NFT.

<!-- prettier-ignore-start -->
```js
const protectedData = await dataProtector.protectData({
  data: { // [!code focus]
    email: 'example@gmail.com', // [!code focus]
  }, // [!code focus]
});
```
<!-- prettier-ignore-end -->

### name

`string | undefined`

Allows providing a descriptive name for the protected data. This is considered
public metadata, describing the protected data.

```js
const protectedData = await dataProtector.protectData({
  name: 'myEmail', // [!code focus]
  data: {
    email: 'example@gmail.com',
  },
});
```

::: tip

The name is public and not encrypted. If you don't pass a name to your protected
data we will automatically define it as "Untitled".

:::

### onStatusUpdate

`OnStatusUpdateFn<ProtectDataStatuses> | undefined`

Callback function to be notified at intermediate steps.

<!-- prettier-ignore-start -->
```js
const protectedData = await dataProtector.protectData({
  name: 'myEmail',
  data: {
    email: 'example@gmail.com',
  },
  onStatusUpdate: ({ title, isDone }) => {// [!code focus]
    console.log(title, isDone); // [!code focus]
  }, // [!code focus]
});
```
<!-- prettier-ignore-end -->

## Return value

```ts twoslash
import { type ProtectedDataWithSecretProps } from '@iexec/dataprotector';
```

The `protectData` method returns the following fields, either as a JSON object
or as individual fields depending on whether you use the promise or observable
pattern respectively.

### name

`string`

The optional name provided during invocation of the method. If no name is
specified this value defaults to `Untitled`.

### address

`Address`

The ETH address of the newly created `protectedData`.

### owner

`Address`

The ETH address of the creator and owner of this `protectedData`.

### schema

`DataSchema`

Metadata describing the fields provided in the `data` parameter. The data types
are automatically detected and listed in the schema.

::: tip

The following data types are automatically detected:

- Scalars
  - `boolean`
  - `number`
  - `string`
- Binary:
  - `application/octet-stream`
  - `application/pdf`
  - `application/xml`
  - `application/zip`
  - `audio/midi`
  - `audio/mpeg`
  - `audio/x-wav`
  - `image/bmp`
  - `image/gif`
  - `image/jpeg`
  - `image/png`
  - `image/webp`
  - `video/mp4`
  - `video/mpeg`
  - `video/x-msvideo`

Any undetected binary data type is categorized as `application/octet-stream`

:::

### creationTimestamp

`number`

A unix-style timestamp indicating the creation time of this `protectedData`.

### transactionHash

`string`

The ID of the transaction that happened on iExec's side chain. You may view
details on the transaction using the [iExec explorer](https://explorer.iex.ec).

### zipFile

`string`

This is a binary representation of the data stored in the `protectedData`. This
is intended as debug data and we will remove this in a future SDK release.

### encryptionKey

`Uint8Array`

The encryption key generated by the client to encrypt the data. This key is for
your own usage. You will not have to share it in the context of the iExec
protocol or developer tools.

::: tip

The zip file generated is a `Uint8Array`, so if you want to handle the binary
data or download it consider adding a zip extension to it.

:::
